<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Salva Renda Afiliados</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body class="main-page">

  <!-- Top Bar -->
  <div class="top-bar">
    <button id="btn-logout" class="back-button">
      <img src="/assets/logout.svg" alt="Voltar">
    </button>
    <span class="nav-title">Salva Renda Afiliados</span>
    <img src="/assets/logotipo.png" class="nav-logo" alt="Logo Salva Renda">
  </div>
<div id="user-info"></div>
  <!-- Conte√∫do Principal -->
  <div class="container-card">

    <!-- Card 1: Rob√¥ Salva Renda -->
    <a href="https://t.me/SalvaRendaBot" id="card-robo" class="card">
      <img src="/assets/robo.png" class="card-img" alt="Rob√¥ Salva Renda">
      <h2 class="card-title">Rob√¥ Salva Renda</h2>
      <p class="card-text">
        Rob√¥ do Telegram, onde voc√™ envia o link do produto (Shopee, Amazon, Mercado Livre, etc) e geramos os Stories e posts para Grupos de mensageria
      </p>
    </a>

    <!-- Card 2: Salva Renda Afiliados -->
    <a href="roi.html" id="card-robo" class="card">
      <img src="/assets/calculadora.png" class="card-img" alt="Salva Renda Afiliados">
      <h2 class="card-title">Calculadora de Retorno de Investimento (ROI)</h2>
      <p class="card-text">
        Calculadora para analisar o seu investimento e o ganho com esse investimento!
      </p>
    </a>

    <!-- Card GPT: Salva Renda Afiliados -->
    <a href="#" id="card-robo" class="card" onclick="verificarAcesso(event)">
  <img src="/assets/ia.png" class="card-img" alt="Salva Renda Afiliados">
  <h2 class="card-title">Salva Renda Copywriter</h2>
  <p class="card-text">
    Intelig√™ncia artificial que cria legendas e roteiros de v√≠deos, cria√ß√£o de imagens e tudo que voc√™ precisa para o sucesso!
  </p>
</a>

  </div>
  <script>
  async function verificarAcesso(event) {
    event.preventDefault();

    const userId = localStorage.getItem('user_id');
    if (!userId) {
      alert('Voc√™ precisa estar logado.');
      return;
    }

    try {
      const res = await fetch(`/api/assinatura-status/${userId}`);
      const data = await res.json();

      console.log('üîé Status recebido do backend:', data);

      // üîí Valida√ß√£o segura do status
      const status = data.status_assinatura?.toString().trim().toLowerCase();

      if (status === 'ativa') {
        window.open(
          "https://chatgpt.com/g/g-6866bd821eb881918c0e6758ea9e8294-salva-renda-copywriter",
          "_blank",
          "width=1024,height=720"
        );
      } else {
        alert("‚ö†Ô∏è Sua assinatura est√° inativa. Fa√ßa seu plano agora para liberar o acesso!");
        window.location.href = "./planos.html";
      }

    } catch (err) {
      console.error("‚ùå Erro ao verificar assinatura:", err);
      alert("Erro ao verificar assinatura. Tente novamente.");
    }
  }</script>
 <script>   document.addEventListener('DOMContentLoaded', () => {
  const btnLogout = document.getElementById('btn-logout');
  if (btnLogout) {
    btnLogout.addEventListener('click', () => {
      // Remove o token e redireciona ao login
      localStorage.removeItem('token');
      window.location.href = '/login.html';
    });
  }
});</script>
  <script type="module" src="/js/main.js"></script>
</body>
</html>